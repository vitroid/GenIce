import genice3.unitcell
import numpy as np
from cif2ice import cellvectors


class UnitCell(genice3.unitcell.UnitCell):
    """
    dtc単位胞を定義するクラス。
    """

    def __init__(self):

        waters = np.fromstring(
            """
        0.5048 0.7524 0.4343
        0.2476 0.7524 0.4343
        0.2476 0.4952 0.4343
        0.7524 0.2476 0.9343
        0.4952 0.2476 0.9343
        0.7524 0.5048 0.9343
        0.4952 0.2476 0.5657
        0.7524 0.2476 0.5657
        0.7524 0.5048 0.5657
        0.2476 0.7524 0.0657
        0.5048 0.7524 0.0657
        0.6667 0.3333 0.4343
        0.3333 0.6667 0.9343
        0.3333 0.6667 0.5657
        0.4634 0.3777 0.4343
        0.6223 0.0857 0.4343
        0.9143 0.5366 0.4343
        0.5366 0.6223 0.9343
        0.3777 0.9143 0.9343
        0.0857 0.4634 0.9343
        0.9143 0.3777 0.4343
        0.6223 0.5366 0.4343
        0.4634 0.0857 0.4343
        0.3777 0.4634 0.9343
        0.0857 0.6223 0.9343
        0.5366 0.9143 0.9343
        0.5366 0.6223 0.5657
        0.3777 0.9143 0.5657
        0.0857 0.4634 0.5657
        0.4634 0.3777 0.0657
        0.6223 0.0857 0.0657
        0.9143 0.5366 0.0657
        0.0857 0.6223 0.5657
        0.3777 0.4634 0.5657
        0.5366 0.9143 0.5657
        0.6223 0.5366 0.0657
        0.9143 0.3777 0.0657
        0.2476 0.4952 0.0657
        0.6667 0.3333 0.0657
        0.4634 0.0857 0.0657
        """,
            sep=" ",
        ).reshape(-1, 3)

        coord = "relative"

        bondlen = 3.0

        density = 0.610666558384

        cell = cellvectors(
            a=17.3705982487, b=17.370598248698347, c=7.49251160134, C=120.00000000004124
        )

        super().__init__(
            cell=cell,
            waters=waters,
            coord=coord,
            bondlen=bondlen,
            density=density,
            # **kwargs,
        )
