desc = {
    "ref": {"PCOD8321499": "Engel 2018", "engel26": "Engel 2018"},
    "usage": "No options available.",
    "brief": "Hypothetical zeolitic ice",
}

import genice3.unitcell
import numpy as np
from cif2ice import cellvectors
from genice3.util import shortest_distance


class UnitCell(genice3.unitcell.UnitCell):
    """
    PCOD8321499単位胞を定義するクラス。
    """

    def __init__(self, **kwargs):
        graph = None  # pairsがない場合は自動生成

        waters = np.array(
            [
                [0.488392, -0.145329, 0.404387],
                [0.218323, -0.218308, 0.14832],
                [0.496688, -0.356575, 0.055932],
                [-0.171991, -0.015769, 0.325318],
                [0.209368, -0.011642, 0.308165],
                [-0.117154, 0.453008, 0.392823],
                [0.030348, 0.172379, 0.488752],
                [0.073805, 0.456589, 0.233702],
                [-0.12493, -0.35886, 0.074103],
                [0.492306, 0.453049, 0.39244],
                [0.21645, -0.409123, 0.314221],
                [0.679844, -0.148704, 0.23005],
                [0.487796, 0.047896, 0.069571],
                [0.63277, 0.179649, 0.48168],
                [0.214257, 0.183722, 0.151263],
                [0.687112, 0.453543, 0.229988],
                [-0.171827, 0.171851, 0.148306],
                [0.027318, -0.222809, 0.478221],
                [0.488737, -0.144275, -0.09267],
                [0.220967, -0.214751, 0.64868],
                [0.499913, -0.359152, 0.555487],
                [-0.172026, -0.015895, -0.178239],
                [0.211017, -0.00835, -0.19181],
                [-0.116996, 0.452866, -0.104109],
                [0.027599, 0.173436, -0.011312],
                [0.070334, 0.460757, 0.733576],
                [-0.127029, -0.354545, 0.573695],
                [0.492425, 0.452916, -0.104289],
                [0.218653, -0.409213, -0.189391],
                [0.677734, -0.149389, 0.730651],
                [0.484568, 0.046995, 0.569816],
                [0.636751, 0.177648, -0.018353],
                [0.211143, 0.187636, 0.651696],
                [0.686981, 0.453682, 0.733547],
                [-0.174047, 0.174696, 0.648026],
                [0.02655, -0.224306, -0.025459],
            ]
        )

        coord = "relative"

        # bondlen = 3

        cell = cellvectors(
            a=20.09717, b=20.04341, c=20.95821, A=89.5522, B=89.6358, C=60.9317
        )

        bondlen = shortest_distance(waters, cell)
        cell *= 0.276 / bondlen

        super().__init__(
            cell=cell,
            waters=waters,
            coord=coord,
            bondlen=0.276 * 1.2,
            # **kwargs,
        )
